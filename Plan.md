# План автоматизации тестирования веб-сервиса покупки тура

### Предусловия:

Корректные данные при заполнении полей ввода:
+ Номер карты: цифры, 16 шт., в формате **** **** **** ****
+ Месяц: 01-12, но не ранее текущего месяца в случае, если указан текущий год
+ Год: последние две цифры порядкового номера года, но не ранее текущего года, и не более 5ти лет от текущего года
+ Владелец: буквы на латинице (Имя и Фамилия)
+ CVC/CVV: цифровые символы (3 шт.)

Карты, представленные для тестирования (файл data.json):

+ 4444 4444 4444 4441, status APPROVED
+ 4444 4444 4444 4442, status DECLINED

## 1. Перечень автоматизируемых сценариев

### UI

   **Happy path:**
   -  Покупка тура через кнопку `"Купить"`
   1. Успешная покупка при оплате картой с валидным номером и достаточным количеством средств на счете.
Номер карты 4444 4444 4444 4441, остальные поля заполнены корректными значениями.

Ожидаемый результат: появилось всплывающее окно "Успешно. Операция одобрена Банком", в БД появилась запись со статусом APPROVED.
 
 2. Покупка тура при оплате картой с валидным номером и недостаточным количеством средств на счете.
Номер карты 4444 4444 4444 4442, остальные поля заполнены корректными значениями. 

Ожидаемый результат: появилось всплывающее окно "Ошибка! Банк отказал в проведении операции".
В БД появилась запись со статусом DECLINED.

   -  Покупка тура через кнопку `"Купить в кредит"`
   1. Успешная покупка тура в кредит с помощью валидной карты, с достаточным кредитным лимитом.
Номер карты 4444 4444 4444 4441, остальные поля заполнены корректными значениями.

Ожидаемый результат: появляется уведомление "Успешно. Операция одобрена Банком". В БД появилась запись со статусом APPROVED. 

  2. Покупка тура в кредит с помощью валидной карты, с недостаточным кредитным лимитом.
Номер карты 4444 4444 4444 4442, остальные поля заполнены корректными значениями.

Ожидаемый результат: появляется уведомление об ошибке "Ошибка! Банк отказал в проведении операции".
В БД появилась запись со статусом DECLINED.
    
   **Sad path:**
   
   + Покупка тура через кнопку `"Купить"`
   
   1. Оплата по несуществующей карте. Номер карты 1234 1234 1234 1234, остальные поля заполнены корректными значениями.
Ожидаемый результат: появилось всплывающее окно "Ошибка! Банк отказал в проведении операции".

  2. Оплата по карте, с незаполненым полем "Номер карты", остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Номер карты сообщение об ошибке "Поле обязательно для заполнения".

  3. Оплата по карте, с невалидным номером. 
Номер карты 4444 4444 4444 111, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Номер карты сообщение об ошибке "Неверный формат".

  4. Оплата по карте с истекшим сроком действия (Месяц). 
Номер карты 4444 4444 4444 4441, указать предыдущий месяц, текущий год, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Месяц сообщение об ошибке "Неверно указан срок действия карты".

  5. Оплата по карте с истекшим сроком действия (Год). 
Номер карты 4444 4444 4444 4441, указать предыдущий год, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Год появилось сообщение об ошибке "Истёк срок действия карты".

  6. Оплата по карте, где в поле указан невалидный месяц. 
Номер карты 4444 4444 4444 4441, в поле Месяц указать 13, остальные поля заполнены корректными значениями
Ожидаемый результат: под полем Месяц сообщение об ошибке "Неверно указан срок действия карты".

  7. Оплата по карте, где в поле указан невалидный месяц. 
Номер карты 4444 4444 4444 4441, в поле Месяц указать 00, остальные поля заполнены корректными значениями
Ожидаемый результат: под полем Месяц сообщение об ошибке "Неверно указан срок действия карты".

  8. Оплата по карте, с незаполненым полем "Месяц". 
Номер карты 4444 4444 4444 4441, поле Месяц оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Месяц появилось сообщение об ошибке "Поле обязательно для заполнения".

  9. Оплата по карте с незаполненым полем "Год". 
Номер карты 4444 4444 4444 4441, поле Год оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Год появилось сообщение об ошибке "Поле обязательно для заполнения".

  10. Оплата по карте с некорректным значением в поле "Владелец". 
Номер карты 4444 4444 4444 4441, в поле Владелец указать некорректные данные(кириллицу, цифры или спецсимволы), остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Владелец появилось сообщение об ошибке.

  11. Оплата по карте, где в поле Владелец указано только Имя или Фамилия. 
Номер карты 4444 4444 4444 4441, в поле Владелец указать только имя или только фамилию, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Владелец появилось сообщение об ошибке.

  12. Оплата по карте, с незаполненым полем "Владелец". 
Номер карты 4444 4444 4444 4441, поле Владелец оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Владелец появилось сообщение об ошибке "Поле обязательно для заполнения".
  
  13. Оплата по карте, где указано некорректное значение в поле CVC/CVV. 
Номер карты 4444 4444 4444 4441, в поле CVC/CVV ввести 1 цифру, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем CVC/CVV появилось сообщение об ошибке "Неверный формат".

  14. Оплата по карте, с незаполненым полем (CVC/CVV). 
Номер карты 4444 4444 4444 4441, поле CVC/CVV оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем CVC/CVV появилось сообщение об ошибке "Поле обязательно для заполнения".

  + Покупка тура через кнопку `"Купить в кредит"`

   1. Оплата по несуществующей карте. Номер карты 1234 1234 1234 1234, остальные поля заполнены корректными значениями.
Ожидаемый результат: появилось всплывающее окно "Ошибка! Банк отказал в проведении операции".

  2. Оплата по карте, с незаполненым полем "Номер карты", остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Номер карты сообщение об ошибке "Поле обязательно для заполнения".

  3. Оплата по карте, с невалидным номером. 
Номер карты 4444 4444 4444 111, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Номер карты сообщение об ошибке "Неверный формат".

  4. Оплата по карте с истекшим сроком действия (Месяц). 
Номер карты 4444 4444 4444 4441, указать предыдущий месяц, текущий год, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Месяц сообщение об ошибке "Неверно указан срок действия карты".

  5. Оплата по карте с истекшим сроком действия (Год). 
Номер карты 4444 4444 4444 4441, указать предыдущий год, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Год появилось сообщение об ошибке "Истёк срок действия карты".

  6. Оплата по карте, где в поле указан невалидный месяц. 
Номер карты 4444 4444 4444 4441, в поле Месяц указать 13, остальные поля заполнены корректными значениями
Ожидаемый результат: под полем Месяц сообщение об ошибке "Неверно указан срок действия карты".

  7. Оплата по карте, где в поле указан невалидный месяц. 
Номер карты 4444 4444 4444 4441, в поле Месяц указать 00, остальные поля заполнены корректными значениями
Ожидаемый результат: под полем Месяц сообщение об ошибке "Неверно указан срок действия карты".

  8. Оплата по карте, с незаполненым полем "Месяц". 
Номер карты 4444 4444 4444 4441, поле Месяц оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Месяц появилось сообщение об ошибке "Поле обязательно для заполнения".

  9. Оплата по карте с незаполненым полем "Год". 
Номер карты 4444 4444 4444 4441, поле Год оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Год появилось сообщение об ошибке "Поле обязательно для заполнения".

  10. Оплата по карте с некорректным значением в поле "Владелец". 
Номер карты 4444 4444 4444 4441, в поле Владелец указать некорректные данные(кириллицу, цифры или спецсимволы), остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Владелец появилось сообщение об ошибке.

  11. Оплата по карте, где в поле Владелец указано только Имя или Фамилия. 
Номер карты 4444 4444 4444 4441, в поле Владелец указать только имя или только фамилию, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Владелец появилось сообщение об ошибке.

  12. Оплата по карте, с незаполненым полем "Владелец". 
Номер карты 4444 4444 4444 4441, поле Владелец оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем Владелец появилось сообщение об ошибке "Поле обязательно для заполнения".
  
  13. Оплата по карте, где указано некорректное значение в поле CVC/CVV. 
Номер карты 4444 4444 4444 4441, в поле CVC/CVV ввести 1 цифру, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем CVC/CVV появилось сообщение об ошибке "Неверный формат".

  14. Оплата по карте, с незаполненым полем (CVC/CVV). 
Номер карты 4444 4444 4444 4441, поле CVC/CVV оставить пустым, остальные поля заполнены корректными значениями.
Ожидаемый результат: под полем CVC/CVV появилось сообщение об ошибке "Поле обязательно для заполнения".

### API

Необходимо проверить, что при обращении к сервису через API он отдаёт те же данные что и при UI-тестах. Для этого необходимы тесты, которые проверяют разные карты и статус этих карт в базе данных.
 
 * Предусловия:
 
Данные для карты со статусом APPROVED: Номер карты - 4444444444444441, Месяц - 03, Год - 23, Владелец - Petrov Ivan, CVC/CVV - 123

Данные для карты со статусом DECLINED: Номер карты - 4444444444444442, Месяц - 04, Год - 23, Владелец - Petrov Ivan, CVC/CVV - 123

  * Перечень сценариев:

1. При оплате по карте 4444444444444441 (обращение к http://localhost:8080/api/v1/pay) ответ сервера - код 200 OK, статус карты APPROVED
2. При оплате по карте 4444444444444442 (обращение к http://localhost:8080/api/v1/pay) ответ сервера - код 200 OK, статус карты DECLINED
3. При отправке заявки на кредит по карте 4444444444444441 (обращение к http://localhost:8080/api/v1/credit) ответ сервера - код 200 OK, статус карты APPROVED
4. При отправке заявки на кредит по карте 4444444444444442 (обращение к http://localhost:8080/api/v1/credit) ответ сервера - код 200 OK, статус карты DECLINED

## 2. Перечень используемых инструментов с обоснованием выбора
- IntelliJ IDEA - платформа для удобного написания кода, в том числе для тестов.
- Gradle - система сборки проекта. По сравнению с Maven, в Gradle проще подключать зависимости.
- JUnit - библиотека для написания и запуска авто-тестов.
- Selenide - фреймворк для автоматизированного тестирования веб-приложений на основе Selenium WebDriver. 
- Git, GitHub - система контроля версий. Удобство, возможность одновременной параллельной разработки, есть интеграция с IntelliJ IDEA.
- Faker -  система генерации случайных данных для тестов. Позволяет не хардкодить тестовые данные.
- Docker - Нужен для развертывания виртуальных контейнеров и запуске в них баз данных MySQL и PostgreSQL.


## 3. Перечень и описание возможных рисков при автоматизации

- Отсутствие подробного ТЗ и документации;
- Отсутсвие тестовых меток в коде страницы усложнит привязку к CSS-електорам, тесты будут падать при изменениях элементов страницы;
- Технические сложности с настройкой Docker-compose.yml и SUT — возможные проблемы с подключением к БД, cложности c раздельным подключением тестов через БД MySQL и PostgreSQL, SUT не запускается и т.п.;
- Возможны проблемы из-за необходимости поддержки двух СУБД (MySQL, Postgres);
- Использование сторонних библиотек и фреймворков может увеличивать риск возникновения технических проблем

## 4. Интервальная оценка с учётом рисков (в часах)

- Настройка тестового окружения - 3;
- Написание и отладка автотестов - 72;
- Прогон автотестов - 2;
- Подготовка отчетной документации, баг-репортов - 12 часов

## 5. План сдачи работ

Автоматизация 25.01.2023

Подготовка отчетных документов - 01.02.2023
